
single x _ = x;
add k v map idx = equal k idx (\_. v) (\_. map idx);