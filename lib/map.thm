
mapSingle x _ = x;
mapAdd k v map idx = equal k idx (\_. v) (\_. map idx);